<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Create Account</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="js/code.js"></script>
  </head>
  <body class="bg-primary p-1">
    <div
      class="container h-75 d-flex align-items-center justify-content-center"
    >
      <div class="row pt-3">
        <div class="card-sm bg-dark w-100 rounded-5 shadow-lg">
          <div class="card-body-sm bg-dark rounded-5">
            <div class="container-fluid flex-start">
              <button
                type="button"
                class="btn btn-outline-primary rounded-pill mt-5"
                onclick="location.href='index.html'"
              >
                ‚Üê
              </button>
            </div>
            <div
              class="col-sm|md|lg|xl|xxl-6 p-2 mx-5 text-white text-center align-self-center"
              style="display: block"
            >
              <h1 class="display-4 pb-5 pt-2 px-5 mx-5 gap-3">
                Create Account
              </h1>
              <form id="form">
                <div class="row">
                  <div class="col">
                    <div class="mb-3">
                      <label
                        for="fname"
                        class="form-label bg-dark text-primary"
                      >
                        First Name:
                      </label>
                      <input
                        type="text"
                        class="form-control bg-dark text-primary rounded-pill p-2"
                        id="fname"
                        placeholder="First Name"
                        name="fname"
                      />
                      <div id="firstNameError" class="invalid-feedback"></div>
                    </div>
                  </div>
                  <div class="col">
                    <div class="mb-3">
                      <label
                        for="lname"
                        class="form-label bg-dark text-primary"
                      >
                        Last Name:
                      </label>
                      <input
                        type="text"
                        class="form-control bg-dark text-primary rounded-pill p-2"
                        id="lname"
                        placeholder="Last Name"
                        name="lname"
                      />
                      <div id="lastNameError" class="invalid-feedback"></div>
                    </div>
                  </div>
                </div>
                <div class="mb-3 mt-3">
                  <!-- This should be UserName not email -->
                  <label for="email" class="form-label bg-dark text-primary"
                    >Username:
                  </label>
                  <input
                    type="text"
                    class="form-control bg-dark text-primary rounded-pill p-2"
                    id="email"
                    placeholder="Enter username"
                    name="email"
                  />
                  <div id="usernameError" class="invalid-feedback"></div>
                </div>
                <div class="mb-3">
                  <label for="pwd" class="form-label bg-dark text-primary">
                    Password:
                  </label>
                  <input
                    type="text"
                    class="form-control bg-dark text-primary rounded-pill p-2"
                    id="pwd"
                    placeholder="Enter password"
                    name="pswd"
                  />
                  <div id="passwordError" class="invalid-feedback"></div>
                </div>

                <div class="mb-3">
                  <label for="cnfmpwd" class="form-label bg-dark text-primary">
                    Confirm Password:
                  </label>
                  <input
                    type="text"
                    class="form-control bg-dark text-primary rounded-pill p-2"
                    id="cnfmpwd"
                    placeholder="Confirm password"
                    name="pswd"
                  />
                  <div id="confirmPasswordError" class="invalid-feedback"></div>

                  <button
                    id="submit-Button"
                    type="button"
                    class="btn btn-outline-primary rounded-pill mt-5"
                    onclick="prepSignUp()"
                  >
                    Create Account
                  </button>
                  <div id="submitButtonError" class="invalid-feedback"></div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      const firstNameTextField = document.getElementById("fname");
      const lastNameTextField = document.getElementById("lname");
      const usernameTextField = document.getElementById("email");
      const passwordTextField = document.getElementById("pwd");
      const confirmPassword = document.getElementById("cnfmpwd");

      function checkEmptyField(targetElement, textField) {
        if (textField.value.trim() === "") {
          textField.classList.add("is-invalid");
          targetElement.innerHTML = "Field cannot be empty.";
          targetElement.style.display = "block";
        } else {
          textField.classList.remove("is-invalid");
          targetElement.innerHTML = "";
          targetElement.style.display = "none";
        }
      }

      // Script to check if firstname is empty on unfocus (blue)
      firstNameTextField.addEventListener("blur", function () {
        checkEmptyField(
          document.getElementById("firstNameError"),
          firstNameTextField
        );
      });

      // Script to check if last name is empty on unfocus (blur)
      lastNameTextField.addEventListener("blur", function () {
        checkEmptyField(
          document.getElementById("lastNameError"),
          lastNameTextField
        );
      });

      usernameTextField.addEventListener("blur", function () {
        checkEmptyField(
          document.getElementById("usernameError"),
          usernameTextField
        );
      });

      passwordTextField.addEventListener("blur", function () {
        checkEmptyField(
          document.getElementById("passwordError"),
          passwordTextField
        );
      });

      usernameTextField.addEventListener("focus", function () {
        const targetElement = document.getElementById("usernameError");
        if (targetElement.style.display === "block") {
          targetElement.style.display = "none";
        }
      });

      function checkMatchingPasswords(targetElement) {
        if (passwordTextField.value !== confirmPassword.value) {
          confirmPassword.classList.add("is-invalid");
          targetElement.innerHTML = "The passwords do not match.";
          targetElement.style.display = "block";
        } else {
          confirmPassword.classList.remove("is-invalid");
          targetElement.innerHTML = "";
          targetElement.style.display = "none";
        }
      }

      confirmPassword.addEventListener("blur", function () {
        checkMatchingPasswords(document.getElementById("confirmPasswordError"));
      });

      passwordTextField.addEventListener("blur", function () {
        checkMatchingPasswords(document.getElementById("confirmPasswordError"));
      });

      // const submitButton = document.getElementById("submit-Button");
      function prepSignUp() {
        const targetElement = document.getElementById("submitButtonError");
        if (checkIsInvalidFeedback()) {
          targetElement.innerHTML = "Please fix the errors before submitting.";
          targetElement.style.display = "block";
        } else if (checkAllEmptyFields()) {
          targetElement.innerHTML =
            "Please enter information for each field before submitting.";
          targetElement.style.display = "block";
        } else {
          SignUp();
        }
      }

      function checkIsInvalidFeedback() {
        const invalidFields = document.querySelectorAll(
          "input[type='text'].is-invalid"
        );
        return invalidFields.length > 0;
      }

      function checkAllEmptyFields() {
        const from = document.getElementById("form");
        const textFields = form.querySelectorAll('input[type="text"]');
        for (let i = 0; i < textFields.length; i++) {
          if (textFields[i].value.trim() === "") {
            return true;
          }
        }
        return false;
      }
    </script>
  </body>
</html>
